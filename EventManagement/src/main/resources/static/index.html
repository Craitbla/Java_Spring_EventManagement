<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Event Management — учебный фронт</title>
    <link rel="stylesheet" href="style.css">
    <script src="script.js" defer></script>
</head>
<body>
<header class="page-header">
    <h1>Event Management — учебный фронтенд</h1>
    <p class="subtitle">
        Все контроллеры в одном месте: клиенты, мероприятия, бронирования, паспорта, статистика и очистка.
    </p>
</header>

<main class="container">

    <!-- КЛИЕНТЫ -->
    <section id="clients-section" class="section">
        <h2>Клиенты</h2>
        <div class="forms-grid">

            <!-- Создать клиента с паспортом -->
            <form id="client-create-form" class="card">
                <h3>Создать клиента</h3>
                <label>
                    ФИО
                    <input id="client-create-fullName" type="text" required minlength="2" maxlength="100">
                </label>
                <label>
                    Телефон (+7...)
                    <input id="client-create-phone" type="tel" required pattern="^\+7\d{10}$" placeholder="+7XXXXXXXXXX">
                </label>
                <label>
                    Email
                    <input id="client-create-email" type="email" placeholder="user@example.com">
                </label>

                <fieldset class="fieldset">
                    <legend>Паспорт</legend>
                    <label>
                        Серия (4 цифры)
                        <input id="client-create-passport-series" type="text" required pattern="\d{4}" maxlength="4">
                    </label>
                    <label>
                        Номер (6 цифр)
                        <input id="client-create-passport-number" type="text" required pattern="\d{6}" maxlength="6">
                    </label>
                </fieldset>

                <button type="submit">Создать клиента</button>
            </form>

            <!-- Получить клиента по ID -->
            <form id="client-get-form" class="card">
                <h3>Найти клиента по ID</h3>
                <label>
                    ID клиента
                    <input id="client-get-id" type="number" min="1" required>
                </label>
                <button type="submit">Получить</button>
            </form>

            <!-- Поиск клиентов -->
            <form id="client-search-form" class="card">
                <h3>Поиск клиентов</h3>
                <label>
                    Строка поиска
                    <input id="client-search-term" type="text" required>
                </label>
                <p class="hint">
                    Ищет по ФИО, телефону или email (поиск по подстроке).
                </p>
                <button type="submit">Искать</button>
            </form>

            <!-- Все клиенты -->
            <form id="client-all-form" class="card">
                <h3>Все клиенты</h3>
                <p class="hint">GET /api/clients</p>
                <button type="submit">Загрузить список</button>
            </form>

            <!-- Обновить основные данные клиента -->
            <form id="client-update-form" class="card">
                <h3>Обновить данные клиента</h3>
                <label>
                    ID клиента
                    <input id="client-update-id" type="number" min="1" required>
                </label>
                <label>
                    Новое ФИО
                    <input id="client-update-fullName" type="text" required minlength="2" maxlength="100">
                </label>
                <label>
                    Новый телефон
                    <input id="client-update-phone" type="tel" required pattern="^\+7\d{10}$" placeholder="+7XXXXXXXXXX">
                </label>
                <label>
                    Новый Email
                    <input id="client-update-email" type="email">
                </label>
                <button type="submit">Обновить</button>
            </form>

            <!-- Заменить паспорт клиента -->
            <form id="client-passport-form" class="card">
                <h3>Заменить паспорт клиента</h3>
                <label>
                    ID клиента
                    <input id="client-passport-id" type="number" min="1" required>
                </label>
                <label>
                    Новая серия (4 цифры)
                    <input id="client-passport-series" type="text" required pattern="\d{4}" maxlength="4">
                </label>
                <label>
                    Новый номер (6 цифр)
                    <input id="client-passport-number" type="text" required pattern="\d{6}" maxlength="6">
                </label>
                <button type="submit">Заменить паспорт</button>
            </form>

            <!-- Удалить клиента -->
            <form id="client-delete-form" class="card">
                <h3>Удалить клиента</h3>
                <label>
                    ID клиента
                    <input id="client-delete-id" type="number" min="1" required>
                </label>
                <p class="hint">
                    Удалить можно только клиента без активных бронирований.
                </p>
                <button type="submit" class="danger">Удалить</button>
            </form>
        </div>

        <div class="output-container">
            <h3>Ответ сервера (клиенты)</h3>
            <pre id="clients-output" class="output" aria-live="polite"></pre>
        </div>
    </section>

    <!-- СОБЫТИЯ -->
    <section id="events-section" class="section">
        <h2>Мероприятия</h2>
        <div class="forms-grid">

            <!-- Создать мероприятие -->
            <form id="event-create-form" class="card">
                <h3>Создать мероприятие</h3>
                <label>
                    Название
                    <input id="event-create-name" type="text" required>
                </label>
                <label>
                    Дата
                    <input id="event-create-date" type="date" required>
                </label>
                <label>
                    Количество мест
                    <input id="event-create-seats" type="number" min="1" required>
                </label>
                <label>
                    Цена билета
                    <input id="event-create-price" type="number" min="0" step="0.01" required>
                </label>
                <label>
                    Описание
                    <textarea id="event-create-description" rows="3" placeholder="Необязательно"></textarea>
                </label>
                <p class="hint">
                    Статус и другие поля по умолчанию выставляет бэк.
                </p>
                <button type="submit">Создать мероприятие</button>
            </form>

            <!-- Получить мероприятие по ID -->
            <form id="event-get-form" class="card">
                <h3>Найти мероприятие по ID</h3>
                <label>
                    ID мероприятия
                    <input id="event-get-id" type="number" min="1" required>
                </label>
                <button type="submit">Получить</button>
            </form>

            <!-- Все мероприятия -->
            <form id="event-all-form" class="card">
                <h3>Все мероприятия</h3>
                <p class="hint">GET /api/events</p>
                <button type="submit">Загрузить список</button>
            </form>

            <!-- Обновить статус мероприятия -->
            <form id="event-status-form" class="card">
                <h3>Обновить статус мероприятия</h3>
                <label>
                    ID мероприятия
                    <input id="event-status-id" type="number" min="1" required>
                </label>
                <label>
                    Новый статус
                    <select id="event-status-select" required>
                        <option value="">— выберите статус —</option>
                        <option value="запланировано">запланировано (PLANNED)</option>
                        <option value="проходит">проходит (ONGOING)</option>
                        <option value="отменено">отменено (CANCELED)</option>
                        <option value="завершено">завершено (COMPLETED)</option>
                    </select>
                </label>
                <p class="hint">
                    Бизнес-правила переходов статусов проверяет бэк (BusinessValidationException).
                </p>
                <button type="submit">Обновить статус</button>
            </form>

            <!-- Статистика по мероприятию -->
            <form id="event-stat-form" class="card">
                <h3>Статистика мероприятия</h3>
                <label>
                    ID мероприятия
                    <input id="event-stat-id" type="number" min="1" required>
                </label>
                <p class="hint">
                    GET /api/events/{id}/statistics — подтвержденные билеты и выручка.
                </p>
                <button type="submit">Получить статистику</button>
            </form>

            <!-- Удалить мероприятие -->
            <form id="event-delete-form" class="card">
                <h3>Удалить мероприятие</h3>
                <label>
                    ID мероприятия
                    <input id="event-delete-id" type="number" min="1" required>
                </label>
                <p class="hint">
                    Нельзя удалить мероприятия со статусом PLANNED или ONGOING — бэк вернет BUSINESS_RULE_ERROR.
                </p>
                <button type="submit" class="danger">Удалить</button>
            </form>
        </div>

        <div class="output-container">
            <h3>Ответ сервера (мероприятия)</h3>
            <pre id="events-output" class="output" aria-live="polite"></pre>
        </div>
    </section>

    <!-- БРОНИРОВАНИЯ -->
    <section id="reservations-section" class="section">
        <h2>Бронирования билетов</h2>
        <div class="forms-grid">

            <!-- Создать бронирование -->
            <form id="reservation-create-form" class="card">
                <h3>Создать бронирование</h3>
                <label>
                    ID клиента
                    <input id="reservation-create-clientId" type="number" min="1" required>
                </label>
                <label>
                    ID мероприятия
                    <input id="reservation-create-eventId" type="number" min="1" required>
                </label>
                <label>
                    Количество билетов
                    <input id="reservation-create-num" type="number" min="1" required>
                </label>
                <label>
                    Статус при создании (опционально)
                    <select id="reservation-create-status">
                        <option value="">— использовать значение по умолчанию —</option>
                        <option value="подтверждено">подтверждено (CONFIRMED)</option>
                        <option value="отменено">отменено (CANCELED)</option>
                        <option value="ожидает подтверждения">ожидает подтверждения (PENDING_CONFIRMATION)</option>
                    </select>
                </label>
                <p class="hint">
                    Если статус не выбран, бэк поставит PENDING_CONFIRMATION.
                </p>
                <button type="submit">Создать бронирование</button>
            </form>

            <!-- Получить бронирование по ID -->
            <form id="reservation-get-form" class="card">
                <h3>Найти бронирование по ID</h3>
                <label>
                    ID бронирования
                    <input id="reservation-get-id" type="number" min="1" required>
                </label>
                <button type="submit">Получить</button>
            </form>

            <!-- Все бронирования -->
            <form id="reservation-all-form" class="card">
                <h3>Все бронирования</h3>
                <p class="hint">GET /api/ticketReservations</p>
                <button type="submit">Загрузить список</button>
            </form>

            <!-- Подтвердить бронирование -->
            <form id="reservation-confirm-form" class="card">
                <h3>Подтвердить бронирование</h3>
                <label>
                    ID бронирования
                    <input id="reservation-confirm-id" type="number" min="1" required>
                </label>
                <p class="hint">
                    PUT /api/ticketReservations/{id}/confirm
                </p>
                <button type="submit">Подтвердить</button>
            </form>

            <!-- Отменить бронирование -->
            <form id="reservation-cancel-form" class="card">
                <h3>Отменить бронирование</h3>
                <label>
                    ID бронирования
                    <input id="reservation-cancel-id" type="number" min="1" required>
                </label>
                <p class="hint">
                    PUT /api/ticketReservations/{id}/cancel<br>
                    Нельзя отменять позже, чем за день до мероприятия (правило на бэке).
                </p>
                <button type="submit" class="danger">Отменить</button>
            </form>

            <!-- Очистка старых отмененных -->
            <form id="reservation-cleanup-form" class="card">
                <h3>Очистить старые отмененные брони</h3>
                <p class="hint">
                    POST /api/ticketReservations/cleanup/canceled-reservations<br>
                    Удаляет отмененные бронирования старше месяца.
                </p>
                <button type="submit">Очистить</button>
            </form>
        </div>

        <div class="output-container">
            <h3>Ответ сервера (бронирования)</h3>
            <pre id="reservations-output" class="output" aria-live="polite"></pre>
        </div>
    </section>

</main>

<footer class="page-footer">
    <p>Учебный фронт. Все запросы уходят на REST-контроллеры без ролей и авторизации.</p>
</footer>
</body>
</html>
